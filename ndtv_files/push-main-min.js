function getSiteName(){var e="",t=window.location.href;switch(!0){case/\/hindi/.test(t):e="hindi"}return e}!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).firebase=t()}(this,function(){"use strict";var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},o=function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function h(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=h(e[n],t[n]));return e}var e,t,r,d=(r=Error,n(e=s,t=r),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i),s);function i(){this.constructor=e}function s(e,t){var n=r.call(this,t)||this;return n.code=e,n.name="FirebaseError",Object.setPrototypeOf(n,s.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,a.prototype.create),n}var a=(c.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var o=t[0]||{},r=this.service+"/"+e,i=this.errors[e],s=i?function(e,o){return i.replace(f,function(e,t){var n=o[t];return null!=n?n.toString():"<"+t+"?>"})}(0,o):"Error",a=this.serviceName+": "+s+" ("+r+").",c=new d(r,a),u=0,l=Object.keys(o);u<l.length;u++){var p=l[u];"_"!==p.slice(-1)&&(p in c&&console.warn('Overwriting FirebaseError base field "'+p+'" can cause unexpected behavior.'),c[p]=o[p])}return c},c);function c(e,t,n){this.service=e,this.serviceName=t,this.errors=n}var f=/\{\$([^}]+)}/g;function b(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function u(e,t){var n=new g(e,t);return n.subscribe.bind(n)}var l,p,g=(v.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},v.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},v.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},v.prototype.subscribe=function(e,t,n){var o,r=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(o=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,o=["next","error","complete"];n<o.length;n++){var r=o[n];if(r in e&&"function"==typeof e[r])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(o.next=m),void 0===o.error&&(o.error=m),void 0===o.complete&&(o.complete=m);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{r.finalError?o.error(r.finalError):o.complete()}catch(e){}}),this.observers.push(o),i},v.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},v.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},v.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},v.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},v);function v(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}function m(){}function y(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];if(!(t<e.logLevel)){var r=(new Date).toISOString();switch(t){case l.DEBUG:case l.VERBOSE:console.log.apply(console,["["+r+"]  "+e.name+":"].concat(n));break;case l.INFO:console.info.apply(console,["["+r+"]  "+e.name+":"].concat(n));break;case l.WARN:console.warn.apply(console,["["+r+"]  "+e.name+":"].concat(n));break;case l.ERROR:console.error.apply(console,["["+r+"]  "+e.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}}}(p=l=l||{})[p.DEBUG=0]="DEBUG",p[p.VERBOSE=1]="VERBOSE",p[p.INFO=2]="INFO",p[p.WARN=3]="WARN",p[p.ERROR=4]="ERROR",p[p.SILENT=5]="SILENT";var w,k=l.INFO,_=(Object.defineProperty(S.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in l))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),S.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,l.DEBUG].concat(e))},S.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,l.VERBOSE].concat(e))},S.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,l.INFO].concat(e))},S.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,l.WARN].concat(e))},S.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,l.ERROR].concat(e))},S);function S(e){this.name=e,this._logLevel=k,this._logHandler=y}var T=((w={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",w["bad-app-name"]="Illegal App name: '{$appName}",w["duplicate-app"]="Firebase App named '{$appName}' already exists",w["app-deleted"]="Firebase App named '{$appName}' already deleted",w["duplicate-service"]="Firebase service named '{$appName}' already registered",w["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",w),N=new a("app","Firebase",T),P="[DEFAULT]",x=[],D=(Object.defineProperty(O.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),O.prototype.delete=function(){var a=this;return new Promise(function(e){a.checkDestroyed_(),e()}).then(function(){a.firebase_.INTERNAL.removeApp(a.name_);for(var e=[],t=0,n=Object.keys(a.services_);t<n.length;t++)for(var o=n[t],r=0,i=Object.keys(a.services_[o]);r<i.length;r++){var s=i[r];e.push(a.services_[o][s])}return Promise.all(e.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()}))}).then(function(){a.isDeleted_=!0,a.services_={}})},O.prototype._getService=function(e,t){if(void 0===t&&(t=P),this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){var n=t!==P?t:void 0,o=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),n);this.services_[e][t]=o}return this.services_[e][t]},O.prototype._removeServiceInstance=function(e,t){void 0===t&&(t=P),this.services_[e]&&this.services_[e][t]&&delete this.services_[e][t]},O.prototype.extendApp=function(e){var t=this;h(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(x.forEach(function(e){t.INTERNAL.addAuthTokenListener(e)}),x=[])},O.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw N.create("app-deleted",{appName:this.name_})},O);function O(e,t,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=h(void 0,e),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){x.push(e),setTimeout(function(){return e(null)},0)},removeAuthTokenListener:function(t){x=x.filter(function(e){return e!==t})}}}D.prototype.name&&D.prototype.options||D.prototype.delete||console.log("dc");var E=new _("@firebase/app");if("object"==typeof self&&self.self===self&&void 0!==self.firebase){E.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var I=self.firebase.SDK_VERSION;I&&0<=I.indexOf("LITE")&&E.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var A=function e(){var t=function(s){var i={},a={},c={},u={__esModule:!0,initializeApp:function(e,t){void 0===t&&(t={}),"object"==typeof t&&null!==t||(t={name:t});var n=t;void 0===n.name&&(n.name=P);var o=n.name;if("string"!=typeof o||!o)throw N.create("bad-app-name",{appName:String(o)});if(b(i,o))throw N.create("duplicate-app",{appName:o});var r=new s(e,n,u);return d(i[o]=r,"create"),r},app:l,apps:null,SDK_VERSION:"6.3.5",INTERNAL:{registerService:function(n,e,t,o,r){if(void 0===r&&(r=!1),a[n])throw N.create("duplicate-service",{appName:n});function i(e){if(void 0===e&&(e=l()),"function"!=typeof e[n])throw N.create("invalid-app-argument",{appName:n});return e[n]()}return a[n]=e,o&&(c[n]=o,p().forEach(function(e){o("create",e)})),void 0!==t&&h(i,t),u[n]=i,s.prototype[n]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._getService.bind(this,n).apply(this,r?e:[])},i},removeApp:function(e){d(i[e],"delete"),delete i[e]},factories:a,useAsService:f}};function l(e){if(!b(i,e=e||P))throw N.create("no-app",{appName:e});return i[e]}function p(){return Object.keys(i).map(function(e){return i[e]})}function d(e,t){for(var n=0,o=Object.keys(a);n<o.length;n++){var r=f(0,o[n]);if(null===r)return;c[r]&&c[r](t,e)}}function f(e,t){return"serverAuth"===t?null:t}return u.default=u,Object.defineProperty(u,"apps",{get:p}),l.App=s,u}(D);return t.INTERNAL=o({},t.INTERNAL,{createFirebaseNamespace:e,extendNamespace:function(e){h(t,e)},createSubscribe:u,ErrorFactory:a,deepExtend:h}),t}(),C=A.initializeApp;return A.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}}()&&E.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),C.apply(void 0,e)},A}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],t):t((e=e||self).firebase)}(this,function(te){"use strict";try{(function(){te=te&&te.hasOwnProperty("default")?te.default:te;var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function e(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return(s=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function b(i,s,a,c){return new(a=a||Promise)(function(e,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(n,o)}r((c=c.apply(i,s||[])).next())})}function g(n,o){var r,i,s,e,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(s=2&t[0]?i.return:t[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,t[1])).done)return s;switch(i=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=o.call(n,a)}catch(e){t=[6,e],i=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function r(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)s.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s}var i,d=(e(a,i=Error),a);function a(e,t){var n=i.call(this,t)||this;return n.code=e,n.name="FirebaseError",Object.setPrototypeOf(n,a.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,c.prototype.create),n}var c=(t.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var o=t[0]||{},r=this.service+"/"+e,i=this.errors[e],s=i?function(e,o){return i.replace(f,function(e,t){var n=o[t];return null!=n?n.toString():"<"+t+"?>"})}(0,o):"Error",a=this.serviceName+": "+s+" ("+r+").",c=new d(r,a),u=0,l=Object.keys(o);u<l.length;u++){var p=l[u];"_"!==p.slice(-1)&&(p in c&&console.warn('Overwriting FirebaseError base field "'+p+'" can cause unexpected behavior.'),c[p]=o[p])}return c},t);function t(e,t,n){this.service=e,this.serviceName=t,this.errors=n}var f=/\{\$([^}]+)}/g;function n(e,t){var n=new l(e,t);return n.subscribe.bind(n)}var u,l=(p.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},p.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},p.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},p.prototype.subscribe=function(e,t,n){var o,r=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(o=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,o=["next","error","complete"];n<o.length;n++){var r=o[n];if(r in e&&"function"==typeof e[r])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(o.next=h),void 0===o.error&&(o.error=h),void 0===o.complete&&(o.complete=h);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{r.finalError?o.error(r.finalError):o.complete()}catch(e){}}),this.observers.push(o),i},p.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},p.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},p.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},p.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},p);function p(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}function h(){}var v,m,y,w,k=((u={})["only-available-in-window"]="This method is available in a Window context.",u["only-available-in-sw"]="This method is available in a service worker context.",u["should-be-overriden"]="This method should be overriden by extended classes.",u["bad-sender-id"]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",u["permission-default"]="The required permissions were not granted and dismissed instead.",u["permission-blocked"]="The required permissions were not granted and blocked instead.",u["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",u["notifications-blocked"]="Notifications have been blocked.",u["failed-serviceworker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",u["sw-registration-expected"]="A service worker registration was the expected input.",u["get-subscription-failed"]="There was an error when trying to get any existing Push Subscriptions.",u["invalid-saved-token"]="Unable to access details of the saved token.",u["sw-reg-redundant"]="The service worker being used for push was made redundant.",u["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$errorInfo}",u["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",u["token-subscribe-no-push-set"]="FCM returned an invalid response when getting an FCM token.",u["token-unsubscribe-failed"]="A problem occured while unsubscribing the user from FCM: {$errorInfo}",u["token-update-failed"]="A problem occured while updating the user from FCM: {$errorInfo}",u["token-update-no-token"]="FCM returned no token when updating the user to push.",u["use-sw-before-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",u["invalid-delete-token"]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",u["delete-token-not-found"]="The deletion attempt for token could not be performed as the token was not found.",u["delete-scope-not-found"]="The deletion attempt for service worker scope could not be performed as the scope was not found.",u["bg-handler-function-expected"]="The input to setBackgroundMessageHandler() must be a function.",u["no-window-client-to-msg"]="An attempt was made to message a non-existant window client.",u["unable-to-resubscribe"]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$errorInfo}",u["no-fcm-token-for-resubscribe"]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",u["failed-to-delete-token"]="Unable to delete the currently saved token.",u["no-sw-in-reg"]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",u["incorrect-gcm-sender-id"]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",u["bad-scope"]="The service worker scope must be a string with at least one character.",u["bad-vapid-key"]="The public VAPID key is not a Uint8Array with 65 bytes.",u["bad-subscription"]="The subscription must be a valid PushSubscription.",u["bad-token"]="The FCM Token used for storage / lookup was not a valid token string.",u["bad-push-set"]="The FCM push set used for storage / lookup was not not a valid push set string.",u["failed-delete-vapid-key"]="The VAPID key could not be deleted.",u["invalid-public-vapid-key"]="The public VAPID key must be a string.",u["use-public-key-before-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",u["public-vapid-key-decryption-failed"]="The public VAPID key did not equal 65 bytes when decrypted.",u),_=new c("messaging","Messaging",k),S=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),T="https://fcm.googleapis.com";function N(e,t){if(null==e||null==t)return!1;if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=new DataView(e),o=new DataView(t),r=0;r<e.byteLength;r++)if(n.getUint8(r)!==o.getUint8(r))return!1;return!0}function P(e){return(t=e,n=new Uint8Array(t),btoa(String.fromCharCode.apply(String,function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e}(n)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");var t,n}(m=v=v||{}).TYPE_OF_MSG="firebase-messaging-msg-type",m.DATA="firebase-messaging-msg-data",(w=y=y||{}).PUSH_MSG_RECEIVED="push-msg-received",w.NOTIFICATION_CLICKED="notification-clicked";var x=(D.prototype.getToken=function(l,p,d){return b(this,void 0,void 0,function(){var t,n,o,r,i,s,a,c,u;return g(this,function(e){switch(e.label){case 0:t=P(p.getKey("p256dh")),n=P(p.getKey("auth")),o="authorized_entity="+l+"&endpoint="+p.endpoint+"&encryption_key="+t+"&encryption_auth="+n,N(d.buffer,S.buffer)||(r=P(d),o+="&application_pub_key="+r),(i=new Headers).append("Content-Type","application/x-www-form-urlencoded"),s={method:"POST",headers:i,body:o},e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch(T+"/fcm/connect/subscribe",s)];case 2:return[4,e.sent().json()];case 3:return a=e.sent(),[3,5];case 4:throw c=e.sent(),_.create("token-subscribe-failed",{errorInfo:c});case 5:if(a.error)throw u=a.error.message,_.create("token-subscribe-failed",{errorInfo:u});if(!a.token)throw _.create("token-subscribe-no-token");if(!a.pushSet)throw _.create("token-subscribe-no-push-set");return[2,{token:a.token,pushSet:a.pushSet}]}})})},D.prototype.updateToken=function(l,p,d,f,h){return b(this,void 0,void 0,function(){var t,n,o,r,i,s,a,c,u;return g(this,function(e){switch(e.label){case 0:t=P(f.getKey("p256dh")),n=P(f.getKey("auth")),o="push_set="+d+"&token="+p+"&authorized_entity="+l+"&endpoint="+f.endpoint+"&encryption_key="+t+"&encryption_auth="+n,N(h.buffer,S.buffer)||(r=P(h),o+="&application_pub_key="+r),(i=new Headers).append("Content-Type","application/x-www-form-urlencoded"),s={method:"POST",headers:i,body:o},e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch(T+"/fcm/connect/subscribe",s)];case 2:return[4,e.sent().json()];case 3:return a=e.sent(),[3,5];case 4:throw c=e.sent(),_.create("token-update-failed",{errorInfo:c});case 5:if(a.error)throw u=a.error.message,_.create("token-update-failed",{errorInfo:u});if(!a.token)throw _.create("token-update-no-token");return[2,a.token]}})})},D.prototype.deleteToken=function(a,c,u){return b(this,void 0,void 0,function(){var t,n,o,r,i,s;return g(this,function(e){switch(e.label){case 0:t="authorized_entity="+a+"&token="+c+"&pushSet="+u,(n=new Headers).append("Content-Type","application/x-www-form-urlencoded"),o={method:"POST",headers:n,body:t},e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch(T+"/fcm/connect/unsubscribe",o)];case 2:return[4,e.sent().json()];case 3:if((r=e.sent()).error)throw i=r.error.message,_.create("token-unsubscribe-failed",{errorInfo:i});return[3,5];case 4:throw s=e.sent(),_.create("token-unsubscribe-failed",{errorInfo:s});case 5:return[2]}})})},D);function D(){}function O(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),o=new Uint8Array(n.length),r=0;r<n.length;++r)o[r]=n.charCodeAt(r);return o}var E="undefined",I="fcm_token_object_Store";var A=(C.prototype.get=function(t){return this.createTransaction(function(e){return e.get(t)})},C.prototype.getIndex=function(t,n){return this.createTransaction(function(e){return e.index(t).get(n)})},C.prototype.put=function(t){return this.createTransaction(function(e){return e.put(t)},"readwrite")},C.prototype.delete=function(t){return this.createTransaction(function(e){return e.delete(t)},"readwrite")},C.prototype.closeDatabase=function(){return b(this,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:e.sent().close(),this.dbPromise=null,e.label=2;case 2:return[2]}})})},C.prototype.createTransaction=function(s,a){return void 0===a&&(a="readonly"),b(this,void 0,void 0,function(){var t,o,r,i;return g(this,function(e){switch(e.label){case 0:return[4,this.getDb()];case 1:return t=e.sent(),o=t.transaction(this.objectStoreName,a),r=o.objectStore(this.objectStoreName),[4,(n=s(r),new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}}))];case 2:return i=e.sent(),[2,new Promise(function(e,t){o.oncomplete=function(){e(i)},o.onerror=function(){t(o.error)}})]}var n})})},C.prototype.getDb=function(){var o=this;return this.dbPromise||(this.dbPromise=new Promise(function(e,t){var n=indexedDB.open(o.dbName,o.dbVersion);n.onsuccess=function(){e(n.result)},n.onerror=function(){o.dbPromise=null,t(n.error)},n.onupgradeneeded=function(e){return o.onDbUpgrade(n,e)}})),this.dbPromise},C);function C(){this.dbPromise=null}var M,R=(e(F,M=A),F.prototype.onDbUpgrade=function(e,t){var n,o=e.result;switch(t.oldVersion){case 0:(r=o.createObjectStore(this.objectStoreName,{keyPath:"swScope"})).createIndex("fcmSenderId","fcmSenderId",{unique:!1}),r.createIndex("fcmToken","fcmToken",{unique:!0});case 1:(n=indexedDB.open(E)).onerror=function(e){},n.onsuccess=function(e){!function(n){if(n.objectStoreNames.contains(I)){var e=n.transaction(I).objectStore(I),o=new x,r=e.openCursor();r.onerror=function(e){console.warn("Unable to cleanup old IDB.",e)},r.onsuccess=function(){var e=r.result;if(e){var t=e.value;o.deleteToken(t.fcmSenderId,t.fcmToken,t.fcmPushSet),e.continue()}else n.close(),indexedDB.deleteDatabase(E)}}}(n.result)};case 2:var r,i=(r=e.transaction.objectStore(this.objectStoreName)).openCursor();i.onsuccess=function(){var e=i.result;if(e){var t=e.value,n=s({},t);t.createTime||(n.createTime=Date.now()),"string"==typeof t.vapidKey&&(n.vapidKey=O(t.vapidKey)),"string"==typeof t.auth&&(n.auth=O(t.auth).buffer),"string"==typeof t.auth&&(n.p256dh=O(t.p256dh).buffer),e.update(n),e.continue()}}}},F.prototype.getTokenDetailsFromToken=function(t){return b(this,void 0,void 0,function(){return g(this,function(e){if(!t)throw _.create("bad-token");return j({fcmToken:t}),[2,this.getIndex("fcmToken",t)]})})},F.prototype.getTokenDetailsFromSWScope=function(t){return b(this,void 0,void 0,function(){return g(this,function(e){if(!t)throw _.create("bad-scope");return j({swScope:t}),[2,this.get(t)]})})},F.prototype.saveTokenDetails=function(t){return b(this,void 0,void 0,function(){return g(this,function(e){if(!t.swScope)throw _.create("bad-scope");if(!t.vapidKey)throw _.create("bad-vapid-key");if(!t.endpoint||!t.auth||!t.p256dh)throw _.create("bad-subscription");if(!t.fcmSenderId)throw _.create("bad-sender-id");if(!t.fcmToken)throw _.create("bad-token");if(!t.fcmPushSet)throw _.create("bad-push-set");return j(t),[2,this.put(t)]})})},F.prototype.deleteToken=function(n){return b(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return"string"!=typeof n||0===n.length?[2,Promise.reject(_.create("invalid-delete-token"))]:[4,this.getTokenDetailsFromToken(n)];case 1:if(!(t=e.sent()))throw _.create("delete-token-not-found");return[4,this.delete(t.swScope)];case 2:return e.sent(),[2,t]}})})},F);function F(){var e=null!==M&&M.apply(this,arguments)||this;return e.dbName="fcm_token_details_db",e.dbVersion=3,e.objectStoreName="fcm_token_object_Store",e}function j(e){if(e.fcmToken&&("string"!=typeof e.fcmToken||0===e.fcmToken.length))throw _.create("bad-token");if(e.swScope&&("string"!=typeof e.swScope||0===e.swScope.length))throw _.create("bad-scope");if(e.vapidKey&&(!(e.vapidKey instanceof Uint8Array)||65!==e.vapidKey.length))throw _.create("bad-vapid-key");if(e.endpoint&&("string"!=typeof e.endpoint||0===e.endpoint.length))throw _.create("bad-subscription");if(e.auth&&!(e.auth instanceof ArrayBuffer))throw _.create("bad-subscription");if(e.p256dh&&!(e.p256dh instanceof ArrayBuffer))throw _.create("bad-subscription");if(e.fcmSenderId&&("string"!=typeof e.fcmSenderId||0===e.fcmSenderId.length))throw _.create("bad-sender-id");if(e.fcmPushSet&&("string"!=typeof e.fcmPushSet||0===e.fcmPushSet.length))throw _.create("bad-push-set")}var V,L=(e(W,V=A),W.prototype.onDbUpgrade=function(e){e.result.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},W.prototype.getVapidFromSWScope=function(n){return b(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:if("string"!=typeof n||0===n.length)throw _.create("bad-scope");return[4,this.get(n)];case 1:return[2,(t=e.sent())?t.vapidKey:void 0]}})})},W.prototype.saveVapidDetails=function(n,o){return b(this,void 0,void 0,function(){var t;return g(this,function(e){if("string"!=typeof n||0===n.length)throw _.create("bad-scope");if(null===o||65!==o.length)throw _.create("bad-vapid-key");return t={swScope:n,vapidKey:o},[2,this.put(t)]})})},W.prototype.deleteVapidDetails=function(n){return b(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return[4,this.getVapidFromSWScope(n)];case 1:if(!(t=e.sent()))throw _.create("delete-scope-not-found");return[4,this.delete(n)];case 2:return e.sent(),[2,t]}})})},W);function W(){var e=null!==V&&V.apply(this,arguments)||this;return e.dbName="fcm_vapid_details_db",e.dbVersion=1,e.objectStoreName="fcm_vapid_object_Store",e}var U="messagingSenderId",K=(B.prototype.getToken=function(){return b(this,void 0,void 0,function(){var t,n,o,r,i;return g(this,function(e){switch(e.label){case 0:if("denied"===(t=this.getNotificationPermission_()))throw _.create("notifications-blocked");return"granted"!==t?[2,null]:[4,this.getSWRegistration_()];case 1:return n=e.sent(),[4,this.getPublicVapidKey_()];case 2:return o=e.sent(),[4,this.getPushSubscription(n,o)];case 3:return r=e.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(n.scope)];case 4:return(i=e.sent())?[2,this.manageExistingToken(n,r,o,i)]:[2,this.getNewToken(n,r,o)]}})})},B.prototype.manageExistingToken=function(t,n,o,r){return b(this,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return function(e,t,n){if(!n.vapidKey||!N(t.buffer,n.vapidKey.buffer))return!1;var o=e.endpoint===n.endpoint,r=N(e.getKey("auth"),n.auth),i=N(e.getKey("p256dh"),n.p256dh);return o&&r&&i}(n,o,r)?Date.now()<r.createTime+6048e5?[2,r.fcmToken]:[2,this.updateToken(t,n,o,r)]:[4,this.deleteTokenFromDB(r.fcmToken)];case 1:return e.sent(),[2,this.getNewToken(t,n,o)]}})})},B.prototype.updateToken=function(r,i,s,a){return b(this,void 0,void 0,function(){var t,n,o;return g(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,6]),[4,this.iidModel.updateToken(this.messagingSenderId,a.fcmToken,a.fcmPushSet,i,s)];case 1:return t=e.sent(),n={swScope:r.scope,vapidKey:s,fcmSenderId:this.messagingSenderId,fcmToken:t,fcmPushSet:a.fcmPushSet,createTime:Date.now(),endpoint:i.endpoint,auth:i.getKey("auth"),p256dh:i.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(n)];case 2:return e.sent(),[4,this.vapidDetailsModel.saveVapidDetails(r.scope,s)];case 3:return e.sent(),[2,t];case 4:return o=e.sent(),[4,this.deleteToken(a.fcmToken)];case 5:throw e.sent(),o;case 6:return[2]}})})},B.prototype.getNewToken=function(o,r,i){return b(this,void 0,void 0,function(){var t,n;return g(this,function(e){switch(e.label){case 0:return[4,this.iidModel.getToken(this.messagingSenderId,r,i)];case 1:return t=e.sent(),n={swScope:o.scope,vapidKey:i,fcmSenderId:this.messagingSenderId,fcmToken:t.token,fcmPushSet:t.pushSet,createTime:Date.now(),endpoint:r.endpoint,auth:r.getKey("auth"),p256dh:r.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(n)];case 2:return e.sent(),[4,this.vapidDetailsModel.saveVapidDetails(o.scope,i)];case 3:return e.sent(),[2,t.token]}})})},B.prototype.deleteToken=function(o){return b(this,void 0,void 0,function(){var t,n;return g(this,function(e){switch(e.label){case 0:return[4,this.deleteTokenFromDB(o)];case 1:return e.sent(),[4,this.getSWRegistration_()];case 2:return(t=e.sent())?[4,t.pushManager.getSubscription()]:[3,4];case 3:if(n=e.sent())return[2,n.unsubscribe()];e.label=4;case 4:return[2,!0]}})})},B.prototype.deleteTokenFromDB=function(n){return b(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return[4,this.tokenDetailsModel.deleteToken(n)];case 1:return t=e.sent(),[4,this.iidModel.deleteToken(t.fcmSenderId,t.fcmToken,t.fcmPushSet)];case 2:return e.sent(),[2]}})})},B.prototype.getPushSubscription=function(t,n){return t.pushManager.getSubscription().then(function(e){return e||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n})})},B.prototype.requestPermission=function(){throw _.create("only-available-in-window")},B.prototype.useServiceWorker=function(e){throw _.create("only-available-in-window")},B.prototype.usePublicVapidKey=function(e){throw _.create("only-available-in-window")},B.prototype.onMessage=function(e,t,n){throw _.create("only-available-in-window")},B.prototype.onTokenRefresh=function(e,t,n){throw _.create("only-available-in-window")},B.prototype.setBackgroundMessageHandler=function(e){throw _.create("only-available-in-sw")},B.prototype.delete=function(){return b(this,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return e.sent(),[2]}})})},B.prototype.getNotificationPermission_=function(){return Notification.permission},B.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},B.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},B.prototype.getIidModel=function(){return this.iidModel},B);function B(e){var t=this;if(!e.options[U]||"string"!=typeof e.options[U])throw _.create("bad-sender-id");this.messagingSenderId=e.options[U],this.tokenDetailsModel=new R,this.vapidDetailsModel=new L,this.iidModel=new x,this.app=e,this.INTERNAL={delete:function(){return t.delete()}}}var z,H="FCM_MSG",$=(e(q,z=K),q.prototype.onPush=function(e){e.waitUntil(this.onPush_(e))},q.prototype.onSubChange=function(e){e.waitUntil(this.onSubChange_(e))},q.prototype.onNotificationClick=function(e){e.waitUntil(this.onNotificationClick_(e))},q.prototype.onPush_=function(a){return b(this,void 0,void 0,function(){var t,n,o,r,i,s;return g(this,function(e){switch(e.label){case 0:if(!a.data)return[2];try{t=a.data.json()}catch(e){return[2]}return[4,this.hasVisibleClients_()];case 1:return e.sent()?[2,this.sendMessageToWindowClients_(t)]:(n=this.getNotificationData_(t))?(o=n.title||"",[4,this.getSWRegistration_()]):[3,3];case 2:return r=e.sent(),i=n.actions,s=Notification.maxActions,i&&s&&i.length>s&&console.warn("This browser only supports "+s+" actions.The remaining actions will not be displayed."),[2,r.showNotification(o,n)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(t)]:[3,5];case 4:return e.sent(),[2];case 5:return[2]}})})},q.prototype.onSubChange_=function(e){return b(this,void 0,void 0,function(){var t,n,o,r;return g(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return t=e.sent(),[3,3];case 2:throw n=e.sent(),_.create("unable-to-resubscribe",{errorInfo:n});case 3:return e.trys.push([3,5,,8]),[4,t.pushManager.getSubscription()];case 4:return e.sent(),[3,8];case 5:return o=e.sent(),[4,this.getTokenDetailsModel().getTokenDetailsFromSWScope(t.scope)];case 6:if(!(r=e.sent()))throw o;return[4,this.deleteToken(r.fcmToken)];case 7:throw e.sent(),o;case 8:return[2]}})})},q.prototype.onNotificationClick_=function(i){return b(this,void 0,void 0,function(){var t,n,o,r;return g(this,function(e){switch(e.label){case 0:return i.notification&&i.notification.data&&i.notification.data[H]?i.action?[2]:(i.stopImmediatePropagation(),i.notification.close(),(t=i.notification.data[H]).notification&&(n=t.fcmOptions&&t.fcmOptions.link||t.notification.click_action)?[4,this.getWindowClient_(n)]:[2]):[2];case 1:return(o=e.sent())?[3,3]:[4,self.clients.openWindow(n)];case 2:return o=e.sent(),[3,5];case 3:return[4,o.focus()];case 4:o=e.sent(),e.label=5;case 5:return o?(delete t.notification,delete t.fcmOptions,r=G(y.NOTIFICATION_CLICKED,t),[2,this.attemptToMessageClient_(o,r)]):[2]}})})},q.prototype.getNotificationData_=function(e){var t;if(e&&"object"==typeof e.notification){var n=s({},e.notification);return n.data=s({},e.notification.data,((t={})[H]=e,t)),n}},q.prototype.setBackgroundMessageHandler=function(e){if(!e||"function"!=typeof e)throw _.create("bg-handler-function-expected");this.bgMessageHandler=e},q.prototype.getWindowClient_=function(i){return b(this,void 0,void 0,function(){var t,n,o,r;return g(this,function(e){switch(e.label){case 0:return t=new URL(i,self.location.href).href,[4,Y()];case 1:for(n=e.sent(),o=null,r=0;r<n.length;r++)if(new URL(n[r].url,self.location.href).href===t){o=n[r];break}return[2,o]}})})},q.prototype.attemptToMessageClient_=function(t,n){return b(this,void 0,void 0,function(){return g(this,function(e){if(!t)throw _.create("no-window-client-to-msg");return t.postMessage(n),[2]})})},q.prototype.hasVisibleClients_=function(){return b(this,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return[4,Y()];case 1:return[2,e.sent().some(function(e){return"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")})]}})})},q.prototype.sendMessageToWindowClients_=function(r){return b(this,void 0,void 0,function(){var t,n,o=this;return g(this,function(e){switch(e.label){case 0:return[4,Y()];case 1:return t=e.sent(),n=G(y.PUSH_MSG_RECEIVED,r),[4,Promise.all(t.map(function(e){return o.attemptToMessageClient_(e,n)}))];case 2:return e.sent(),[2]}})})},q.prototype.getSWRegistration_=function(){return b(this,void 0,void 0,function(){return g(this,function(e){return[2,self.registration]})})},q.prototype.getPublicVapidKey_=function(){return b(this,void 0,void 0,function(){var t,n;return g(this,function(e){switch(e.label){case 0:return[4,this.getSWRegistration_()];case 1:if(!(t=e.sent()))throw _.create("sw-registration-expected");return[4,this.getVapidDetailsModel().getVapidFromSWScope(t.scope)];case 2:return null==(n=e.sent())?[2,S]:[2,n]}})})},q);function q(e){var t=z.call(this,e)||this;return t.bgMessageHandler=null,self.addEventListener("push",function(e){t.onPush(e)}),self.addEventListener("pushsubscriptionchange",function(e){t.onSubChange(e)}),self.addEventListener("notificationclick",function(e){t.onNotificationClick(e)}),t}function Y(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function G(e,t){var n;return(n={})[v.TYPE_OF_MSG]=e,n[v.DATA]=t,n}var Z,J,X=(e(Q,Z=K),Q.prototype.getToken=function(){return b(this,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return this.manifestCheckPromise||(this.manifestCheckPromise=function(){return b(this,void 0,void 0,function(){var t,n;return g(this,function(e){switch(e.label){case 0:if(!(t=document.querySelector('link[rel="manifest"]')))return[2];e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch(t.href)];case 2:return[4,e.sent().json()];case 3:return n=e.sent(),[3,5];case 4:return e.sent(),[2];case 5:if(!n||!n.gcm_sender_id)return[2];if("103953800507"!==n.gcm_sender_id)throw _.create("incorrect-gcm-sender-id");return[2]}})})}()),[4,this.manifestCheckPromise];case 1:return e.sent(),[2,Z.prototype.getToken.call(this)]}})})},Q.prototype.requestPermission=function(){return b(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return"granted"===this.getNotificationPermission_()?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?_.create("permission-blocked"):_.create("permission-default")}})})},Q.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw _.create("sw-registration-expected");if(null!=this.registrationToUse)throw _.create("use-sw-before-get-token");this.registrationToUse=e},Q.prototype.usePublicVapidKey=function(e){if("string"!=typeof e)throw _.create("invalid-public-vapid-key");if(null!=this.publicVapidKeyToUse)throw _.create("use-public-key-before-get-token");var t=O(e);if(65!==t.length)throw _.create("public-vapid-key-decryption-failed");this.publicVapidKeyToUse=t},Q.prototype.onMessage=function(e,t,n){return"function"==typeof e?this.onMessageInternal(e,t,n):this.onMessageInternal(e)},Q.prototype.onTokenRefresh=function(e,t,n){return"function"==typeof e?this.onTokenRefreshInternal(e,t,n):this.onTokenRefreshInternal(e)},Q.prototype.waitForRegistrationToActivate_=function(o){var r=o.installing||o.waiting||o.active;return new Promise(function(e,t){if(r)if("activated"!==r.state)if("redundant"!==r.state){var n=function(){if("activated"===r.state)e(o);else{if("redundant"!==r.state)return;t(_.create("sw-reg-redundant"))}r.removeEventListener("statechange",n)};r.addEventListener("statechange",n)}else t(_.create("sw-reg-redundant"));else e(o);else t(_.create("no-sw-in-reg"))})},Q.prototype.getSWRegistration_=function(){var t=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register(serviceWorkerPath,{scope:BASE_URL}).catch(function(e){throw _.create("failed-serviceworker-registration",{browserErrorMessage:e.message})}).then(function(e){return t.waitForRegistrationToActivate_(e).then(function(){return(t.registrationToUse=e).update(),e})}))},Q.prototype.getPublicVapidKey_=function(){return b(this,void 0,void 0,function(){return g(this,function(e){return this.publicVapidKeyToUse?[2,this.publicVapidKeyToUse]:[2,S]})})},Q.prototype.setupSWMessageListener_=function(){var o=this;navigator.serviceWorker.addEventListener("message",function(e){if(e.data&&e.data[v.TYPE_OF_MSG]){var t=e.data;switch(t[v.TYPE_OF_MSG]){case y.PUSH_MSG_RECEIVED:case y.NOTIFICATION_CLICKED:var n=t[v.DATA];o.messageObserver&&o.messageObserver.next(n)}}},!1)},Q);function Q(e){var t=Z.call(this,e)||this;return t.registrationToUse=null,t.publicVapidKeyToUse=null,t.manifestCheckPromise=null,t.messageObserver=null,t.tokenRefreshObserver=null,t.onMessageInternal=n(function(e){t.messageObserver=e}),t.onTokenRefreshInternal=n(function(e){t.tokenRefreshObserver=e}),t.setupSWMessageListener_(),t}function ee(){return self&&"ServiceWorkerGlobalScope"in self?"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}J={isSupported:ee},te.INTERNAL.registerService("messaging",function(e){if(!ee())throw _.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new $(e):new X(e)},J)}).apply(this,arguments)}catch(e){throw console.error(e),new Error("Cannot instantiate firebase-messaging - be sure to load firebase-app.js first.")}});var __siteName=getSiteName(),site="g360"+__siteName,__cname="_notifystfcm_"+site,__indexDBcname="_notifycheckindb_"+site,popupShow=!1,setupDone=!1;"undefined"==typeof querySt||"app"!=querySt("from")&&""==getCookie("gadgets360app")||(setupDone=!0);var oldToken="";apiUrlbasePath="https://gadgets.ndtv.com/"==BASE_URL?"https://apis.kostprice.com/":"https://stage.pricee.com/";var subscribeApi=apiUrlbasePath+"api/v1/subscribe.php",waitForNotifyAction=!1,ep="";function isSupportedNotification(){return"serviceWorker"in navigator&&"PushManager"in window}function get_browser_info(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],o="desktop",r="unknown-os";return-1!=t.indexOf("Edge/")&&(n=t.match(/(edge(?=\/))\/?\s*(\d+)/i)),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)&&(o="mobile"),-1!=navigator.appVersion.indexOf("Win")&&(r="windows"),-1!=navigator.appVersion.indexOf("Mac")&&(r="mac"),-1!=navigator.appVersion.indexOf("X11")&&(r="unix"),-1!=navigator.appVersion.indexOf("Linux")&&(r="linux"),-1!=t.indexOf("Android")&&(r="android"),/trident/i.test(n[1])?{name:"ie",version:(e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||"",device:o,os:r}:"Chrome"===n[1]&&null!=(e=t.match(/\bOPR\/(\d+)/))?{name:"opera",version:e[1],device:o,os:r}:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),{name:n[0].toLowerCase(),version:n[1],device:o,os:r})}function setCookieVal(e,t,n){var o=new Date,r=new Date(o.getTime()+864e5*n),i=escape(t)+"|"+r.getTime()+(null==n?"":"; expires="+r.toUTCString()+";path=/;");document.cookie=e+"="+i}function getCookieVal(e){var t,n,o,r=document.cookie.split(";");for(t=0;t<r.length;t++)if(n=r[t].substr(0,r[t].indexOf("=")),o=r[t].substr(r[t].indexOf("=")+1),val=o,(n=n.replace(/^\s+|\s+$/g,""))==e)return"N"==o.substring(0,1)&&(-1!=o.indexOf("|")?(val=o.substring(0,1),timeArr=o.split("|"),d=new Date,d.getTime()>timeArr[1]&&(val="")):val=""),unescape(val);return""}var binfo=get_browser_info();function checkSetup(e){isSupportedNotification()&&("Y"==getCookieVal("_notifyst_"+site+"_")||e?requestPermission():window.indexedDB?checkExpiryDate():checkShowPopup())}function checkShowPopup(){""==(getCookieVal(__cname)||"")&&(timeout=waitForNotifyAction?0:1e3,setTimeout(function(){__showSubscribePopup()},timeout))}function __showSubscribePopup(){var e=document.getElementById("__notify");if(e){var t="mobile"==binfo.device?".web_dialognotify{width:100%}":"",n="Subscribe to Gadgets 360 alerts",o="For breaking tech news, latest reviews, and more",r="Yes",i="No";switch(__siteName){case"hindi":n="गैजेट्स 360 अलर्ट के लिए सब्सक्राइब करें",o="ब्रेकिंग टेक न्यूज़, लेटेस्ट रिव्यू और अन्य टेक खबरों के लिए.",r="हां",i="नही"}e.innerHTML="<style>.web_dialog_overlayproductshop,.web_dialognotify{display:none;position:fixed;z-index:99999999;left:0;right:0;-webkit-font-smoothing: antialiased;-moz-osx-font-smoothing: grayscale;}.clear{clear:both}.web_dialog_overlayproductshop{height:100%;opacity:.8;bottom:0;margin:0;padding:0}.web_dialognotify{background-color:#fff;height:auto;opacity:1;text-align:center;font-family:Arial,sans-serif;width:400px;margin:auto;top:0;min-height:100px;border-radius:0 0 5px 5px;box-shadow:0 0 10px #999;padding:15px 10px;cursor:auto}.web_dialognotify .bn_wrp{text-align:left}.web_dialognotify .bn_wrp .logo{margin:-3px 10px 10px 0;float:left;width:65px}.web_dialognotify .bn_wrp .heading{margin:0 0 8px;font-size:15px;font-weight:600;line-height:18px}.web_dialognotify .bn_wrp p{margin:0 10px;font-size:14px}.web_dialognotify .bn_wrp .bn_buttons{margin:20px 0 0}.bn_wrp .bn_notnow,.web_dialognotify .bn_wrp .bn_close{float:right;padding:4px 20px;margin:0 5px;font-size:12px;border:none;cursor:pointer}.web_dialognotify .bn_wrp .bn_close:hover{background:#4FACEF;border:1px solid #4B84AD;color:#FFF}.web_dialognotify .bn_wrp .bn_notnow{text-decoration:underline;background:none;}.web_dialognotify .bn_wrp .bn_close{border:1px solid #999;text-transform:uppercase;border-radius:4px}"+t+"                        @-webkit-keyframes bounceInRight{0%,60%,75%,90%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:translate3d(3000px,0,0);transform:translate3d(3000px,0,0)}60%{opacity:1;-webkit-transform:translate3d(-25px,0,0);transform:translate3d(-25px,0,0)}75%{-webkit-transform:translate3d(10px,0,0);transform:translate3d(10px,0,0)}90%{-webkit-transform:translate3d(-5px,0,0);transform:translate3d(-5px,0,0)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes bounceInRight{0%,60%,75%,90%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:translate3d(3000px,0,0);transform:translate3d(3000px,0,0)}60%{opacity:1;-webkit-transform:translate3d(-25px,0,0);transform:translate3d(-25px,0,0)}75%{-webkit-transform:translate3d(10px,0,0);transform:translate3d(10px,0,0)}90%{-webkit-transform:translate3d(-5px,0,0);transform:translate3d(-5px,0,0)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}.bounceInRight{-webkit-animation-name:bounceInRight;animation-name:bounceInRight}                        .animated{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both}                        </style>",e.innerHTML+='<div id="overlaynotify_cnt"></div><div id="bnotify" class="web_dialog web_dialognotify web_dialogproduct animated bounceInRight" style="display:none"><div class="web_dialog_content"><div class="bn_wrp"><img class="logo" src="https://cdn.gadgets360.com/shop/assets/products/gadgets360.png" width="60"/><span class="heading">'+n+"</span><p>"+o+'</p><div class="bn_buttons"><button id="btnallow" class="bn_close">'+r+'</button><button id="btnClosenotify" class="bn_notnow">'+i+'</button><div class="clear"></div></div></div></div></div>',popupShow=!0,ShowDialogProductpopup()}}function ShowDialogProductpopup(){$("#overlaynotify_cnt").show(),$("#bnotify").fadeIn(300),$("#overlaynotify_cnt").click(function(e){HideDialogProductpopup()})}function HideDialogProductpopup(){$("#bnotify").fadeOut(300),$("#overlaynotify_cnt").hide()}function hideNotifyPopup(e){setNotifyStatusCookie(e),HideDialogProductpopup()}function setNotifyStatusCookie(e){"Y"==e?(setCookieVal(__cname,"Y",30),popupShow=!1):setCookieVal(__cname,"N",30)}function getSubscription(){messaging.getToken().then(function(e){e&&(subscribeNow(e,""),flag="Y"!=getCookieVal("_notifyst_"+site+"_")&&!waitForNotifyAction,flag&&onRegisterNotify())}).catch(function(e){console.log("An error occurred while retrieving token. ",e.message)})}function requestPermission(){Notification.requestPermission().then(function(e){"granted"===e?getSubscription():(console.log("Unable to get permission to notify."),"function"==typeof savePriceDrop&&waitForNotifyAction&&(savePriceDrop(),waitForNotifyAction=!1))})}function subscribeNow(t,n){platform="undefined"!=typeof IS_MOBILE&&1==IS_MOBILE?"mobile":"desktop",dtid=isLocalStorageSupported()&&null!=localStorage.getItem(site+"_ntf_id")?localStorage.getItem(site+"_ntf_id"):0,$.ajax({url:subscribeApi,type:"POST",data:{token:t,old_token:oldToken,browser:binfo.name,unregister:n,platform:platform,os:binfo.os,dtid:dtid},success:function(e){hideNotifyPopup(n?"N":"Y"),isLocalStorageSupported()&&void 0!==ep&&""!=ep&&(removeOldToken(ep),localStorage.setItem(site+"_ntf_old_tkn_del",1)),isLocalStorageSupported()&&void 0!==e.dtid&&localStorage.setItem(site+"_ntf_id",e.dtid),"function"==typeof savePriceDrop&&waitForNotifyAction&&(fcmToken=t,savePriceDrop(),waitForNotifyAction=!1)}})}function unSubscribe(){isLocalStorageSupported()&&null!=localStorage.getItem(site+"_ntf_id")?messaging.getToken().then(function(e){messaging.deleteToken(e).then(function(){subscribeNow(e,1),setCookieVal(__cname,"N",30)}).catch(function(e){console.log("Unable to delete token. ",e)})}).catch(function(e){console.log("Error retrieving Instance ID token. ",e)}):navigator.serviceWorker.getRegistrations().then(function(e){e.forEach(function(e){e.pushManager.getSubscription().then(function(e){e&&(endpoint=getEndPoint(e),removeOldToken(endpoint),setCookieVal(__cname,"N",30))})})})}function onRegisterNotify(){navigator.serviceWorker.getRegistration().then(function(e){try{var t="Thank you for subscribing to Gadgets 360 alerts.",n="https://gadgets.ndtv.com/?notify";switch(__siteName){case"hindi":t="गैजेट्स 360 अलर्ट सब्सक्राइब करने के लिए धन्यवाद.",n="https://gadgets.ndtv.com/hindi?notify"}e.showNotification("gadgets360.com",{body:t,icon:"https://cdn.gadgets360.com/shop/assets/products/g360-icon.png",vibrate:[300,100,400],tag:"gadgets360-welcome",data:{url:n}}).onclick=function(e){e.target.close(),window.location.href=e.target.data.url}}catch(e){}})}$(window).scroll(function(){setupDone||(setupDone=!0,checkSetup(0))}),$("body").on("click","#btnClosenotify",function(e){hideNotifyPopup("N"),e.preventDefault(),window.indexedDB&&setCookieVal(__indexDBcname,"Y",1)}),$("body").on("click","#btnallow",function(e){hideNotifyPopup("Y"),requestPermission(),e.preventDefault()});var serviceWorkerPath=BASE_URL+"sw-main?ver=v"+(new Date).getUTCFullYear()+(new Date).getUTCMonth()+(new Date).getUTCDate();function registerServiceWorker(){if(!isSupportedNotification())return!1;isLocalStorageSupported()&&null===localStorage.getItem(site+"_ntf_old_tkn_del")&&navigator.serviceWorker.getRegistrations().then(function(e){e.forEach(function(e){e.pushManager.getSubscription().then(function(e){e&&(ep=getEndPoint(e),oldToken=e.endpoint.split("/").slice(-1)[0])})})}),navigator.serviceWorker.register(serviceWorkerPath,{scope:BASE_URL}).then(function(e){console.log("Service Worker registration successful")}).catch(function(e){console.log("Service Worker registration failed",e.message)})}function removeOldToken(e){$.ajax({type:"POST",dataType:"json",url:"https://ipush.apps.ndtv.com/subscribeCricketChrome.php",data:{packageName:"gadgets360"+__siteName+"."+e.browser,env:"PRODUCTION",matchid:"",teams:"",unregister:1,registration_id:e.id}})}function getEndPoint(e){var t="https://android.googleapis.com/gcm/send/",n=e.endpoint.split(t);return 1<n.length?{browser:"chrome",id:n[1]}:(t="https://fcm.googleapis.com/fcm/send/",1<(n=e.endpoint.split(t)).length?{browser:"chrome",id:n[1]}:(t="https://updates.push.services.mozilla.com/push/",1<(n=e.endpoint.split(t)).length?{browser:"firefox",id:n[1]}:(t="https://updates.push.services.mozilla.com/wpush/",1<(n=e.endpoint.split(t)).length?{browser:"firefox",id:n[1]}:"")))}function isLocalStorageSupported(){try{return localStorage.setItem("testlocal","1"),localStorage.removeItem("testlocal"),!0}catch(e){return!1}}function checkExpiryDate(){try{var e=getCookieVal(__indexDBcname)||"";window.indexedDB&&""==e&&(console.log("checking indexedDB"),openRequest=indexedDB.open("g360_settings",1),openRequest.onupgradeneeded=function(e){openRequest.result.createObjectStore("settings",{keyPath:"type"}).createIndex("type","type",{unique:!0})},openRequest.onsuccess=function(e){if(allowNotification=getCookieVal(__cname).substring(0,1),""!=allowNotification&&setCookieVal(__indexDBcname,"Y",1),db=openRequest.result,db.objectStoreNames.contains("settings")){var t=db.transaction("settings").objectStore("settings").get("notify");t.onsuccess=function(e){void 0!==t.result&&(currentDate=new Date,currentTs=currentDate.getTime(),lastNotificationTs=t.result.data.last_notification_ts,1e12<lastNotificationTs&&"Y"==allowNotification&&(remainingDaysTs=lastNotificationTs+2592e6,remainingDays=0<remainingDaysTs-currentTs?Math.round((remainingDaysTs-currentTs)/864e5):0,setCookieVal(__cname,"Y",remainingDays))),checkShowPopup()}}})}catch(e){console.log("Error reading indexedDB")}}registerServiceWorker(),$(document).on("click",function(e){popupShow&&"notifysubclick"!=e.target.id&&"btnallow"!=e.target.id&&"overlaynotify_cnt"!=e.target.id&&"subscribe-anch"!=e.target.id&&"subscribe-icon"!=e.target.id&&"subscribe-txt"!=e.target.id&&(setNotifyStatusCookie("N"),HideDialogProductpopup(),popupShow=!1)}),firebase.initializeApp({messagingSenderId:"759592359455"});var messaging=firebase.messaging();messaging.usePublicVapidKey("BJNbs1NOXk___M_Zhjjd23MLdpHT_WG38njDBlyZ0ZbP_47lbSZGjNvswmlkU57eQyKIEFLR0aYJKLrZ2BvgaNE"),messaging.onTokenRefresh(function(){messaging.getToken().then(function(e){subscribeNow(e,"")}).catch(function(e){console.log("Unable to retrieve refreshed token ",e.message)})});